---
title: "Локальные дейктики и жестикуляция"
output:
  pdf_document:
    keep_tex: yes
    latex_engine: xelatex
  html_document: default
mainfont: Liberation Serif
monofont: Liberation Mono
date: "2023-06-06"
---

# Локальные дейктики и жестикуляция

## О проекте

Проект посвящен изучению связи вербального и кинетического каналов коммуникации и их участии в указании.

**Цель проекта** - исследовать данную связь статистически.

Для проекта был выбран датасет SaGA (подробнее в Lücking et al., 2010; Kucherenko, 2021). Он мультимодален, состоит из 25 видео, в которых производится указание пути одним участником другому. Язык датасета - немецкий.

Датасет доступен по [ссылке](https://zenodo.org/record/6546229).

### Источники:

1.  Lücking, A., Bergmann, K., Hahn, F., Kopp, S., & Rieser, H. (2010). [*The Bielefeld Speech and Gesture Alignment Corpus (SaGA)*](https://pub.uni-bielefeld.de/download/2001935/2534579/final_version.pdf). In M. Kipp, J. - P. Martin, P. Paggio, & D. Heylen (Eds.), LREC 2010 Workshop: Multimodal Corpora--Advances in Capturing, Coding and Analyzing Multimodality (pp. 92-98).

2.  Kucherenko, T., Nagy, R., Neff, M., Kjellström, H., & Henter, G. E. (2021). [*Multimodal analysis of the predictability of hand-gesture properties*](https://arxiv.org/pdf/2108.05762.pdf). arXiv preprint arXiv:2108.05762.

## Данные

Исходный датасет включает в себя 1) файлы с аннотациями к видео (.eaf), 2) файлы с аудиальными признаками (.npy), 3) файлы с 3д-моделированием кинетического поведения говорящих (.bvh). Для исследования были взяты только первые файлы, из которых с помощью программы ELAN были получены аннотации нужных слоёв в текстовом виде. Полученный файл далее обрабатывался с помощью языка программирования Python.

Аннотация датасета включает в себя транскрипт речи говорящих (дающего указания и им следующего), лемматизированный и размеченный частеречно, информацию о различных характеристиках жестов отдельно для каждой из рук и также их вместе.

Процесс обработки данных описан в скрипте `preprocessing_data.py`. Он заключался в сопоставлении аннотаций с разных слоев по времени для дальнейшего создания датасета, содержащего произносимые слова (а также их леммы и часть речи) и сопоставленные им жестовые характеристики (тип жеста, фаза жеста, семантика жеста и др. характеристики). Далее для каждой леммы была проведена дополнительная разметка, является ли лексема дейтиком. Для этого был составлен список немецких дейктических единиц, исходя из работы Blühdorn (1994), а также ресурсов 2 и 3. Заметим, что отбирались только единицы, которые относятся к категориям *Zeichendeiktika* и *Lokaldeiktika* у Blühdorn'а, поскольку связь между жестами и местными дейктиками наиболее сильна, а также из-за специфики материала, фокусирующегося на указании на местности.

### Источники:

1.  Blühdorn, H. (1994). [*Deixis und Deiktika in der deutschen Gegenwartssprache*](https://ids-pub.bsz-bw.de/frontdoor/deliver/index/docId/1812/file/Bl%c3%bchdorn_Deixis_und_Deiktika_1994.pdf). Deutsche Sprache, 21(1), 44-62.

2.  [*Präpositionaladverb*](https://gsw.phil-fak.uni-duesseldorf.de/diskurslinguistik/index.php?title=Pr%C3%A4positionaladverb).

3.  [*Deiktisches Adverb*](https://grammis.ids-mannheim.de/systematische-grammatik/524).

Подгружаем данные...

```{r}
data <- read.csv("https://raw.githubusercontent.com/anna-a-m/andan-project/main/data.csv")
```

## Анализ статистики

```{r}
library(tidyverse)
```

```{r}
str(data)
```

В полученном датасете **90,776** наблюдений и 11 признаков, первые три из которых описывают речевую составляющую, следующие 7 жестовую. Последний же признак - это наша целевая переменная. Далее посмотрим на её распределение в датасете.

```{r}
data %>%
  count(IsDeictic, sort = TRUE, name = "count") %>%
  mutate(part = round(count/nrow(data), digits=2))
```

Целевая переменная, дейктик ли лемма, распределена крайне неравномерно. Она составляет только 10-ю часть всего датасета.

Посмотрим, сколько уникальных значений имеют жестовые признаки и каковы эти значения.

```{r}
data[, 5:length(data)-1] %>%
  summarise_each(list(n_distinct)) %>%
  pivot_longer(cols=Phrase:PalmDirection, names_to="Variable", values_to="Distinct_count") %>%
  arrange(Distinct_count)
```

```{r}
data %>%
  filter(Phase != "") %>%
  distinct(Phase, IsDeictic) %>%
  arrange(IsDeictic)
```

Как видно, по признаку фазы жеста, что дейктики и не-дейктики не различаются. Это логично, поскольку само протекание жеста не должно зависеть от произносимой вербальной составляющей. Так, у жеста есть три основных фазы: экскурсия, выдержка и ретракция (примерно так же, как и у артикуляции звука в акустике). Также жест может быть прерван или задержан в фазе экскурсии или ретракции.

```{r}
data %>%
  filter(Phrase != "") %>%
  distinct(Phrase, IsDeictic) %>%
  arrange(IsDeictic)
```

В датасете присутствуют достаточно много разных типов жестов как для дейктиков, так и для не-дейктиков. Интересно, что и не-дейктики часто сопровождаются указательными жестами. Посмотрим, какие именно это слова.

```{r}
data %>%
  select(Lemma, Phrase, IsDeictic) %>%
  filter(IsDeictic == 'non-deictic') %>%
  filter(stringr::str_detect(Phrase, 'deictic')) %>%
  distinct(Lemma) %>%
  sample_n(30)
```

Указательные жесты сопровождаются

-   неразмеченными в датасете дейктиками (поскольку либо не являются локальными, либо не входят в выбранную классификацию),

    *dies, jen, dann*

-   местные предлоги,

    *hinterm, über*

-   наименования мест,

    *Kirche, Park, See*

-   глаголы действия,

    *stehen, biegen*

-   междометия и дискурсивные слова

    *quasi, aeh*

Сбалансируем наш датасет, убрав из него те слова, которые сопровождаются указательными жестами, чтобы сделать более явной разницу между предметом исследования, локальными дейктиками, и другими вербальными единицами. При этом в таком случае будем считать признак Phrase менее значимым для наблюдений.

```{r}
non_deictics <- data %>% 
  filter(IsDeictic == 'non-deictic') %>%
  filter(!stringr::str_detect(Phrase, 'deictic'))

non_deictics <- non_deictics[sample(1:nrow(non_deictics)), ]
non_deictics <- non_deictics %>%
  drop_na()
non_deictics <- non_deictics[1:8311,]
```

```{r}
deictics <- data %>%
  filter(IsDeictic == 'deictic')

final_df <- bind_rows(deictics, non_deictics)
final_df <- final_df %>%
  mutate(across(where(is.character), as.factor))

final_df %>%
  count(IsDeictic, name="count")
```

## Визуализации

### График-мозаика распределения признака Phrase

Посмотрим, как теперь распределён наш признак Phrase. Он представляет собой категоризацию жеста по типу. Жесты бывают иллюстративные (когда мы словно изображаем вербальную составляющую), ритмические (они поддерживают ритмическую структуру речи, помогают сохранить темп речи), дискурсивные, указательные, а также их сочетания.

```{r fig.width = 18, fig.height=15}
library(vcd)
mosaic(IsDeictic ~ Phrase, data=final_df,
       main = "Phrase feature distribution",
       direction=c("h","v"), spacing=spacing_increase(),
       gp = gpar(fill=c('lightblue', 'lightgreen')))
```

На графике заметно, что целевая переменная распределена равномерно. Из-за фильтрации датасета указательных жестов нет в части с не-дейктиками. Среди не-дейктиков также чаще встречаются дискурсивные, иллюстративные и ритмические жесты.

Отметим, что в целом иллюстративные жесты очень распространены. Также часто используются указательные жесты. Где-то в пятой части случаев жесты не используются (первая "строка" мозаики), причём при не-дейктиках чаще, чем при них.

### Столбчатая диаграмма для признака Semantic

Под семантикой жеста в данном датасете понимается абстрактные категории, которые уточняются жестом - размер объекта в пространстве, его относительная позиция, форма или количество, а также совмещение данных признаков.

Поскольку для многих жестов не определён данный признак, посмотрим только на ту часть, для которой он размечен.

```{r fig.width=17}
semantic <- final_df %>%
  filter(Semantic != "")
ggplot(semantic, aes(x=reorder(Semantic, Semantic, function(x)-length(x)))) +
geom_bar(fill='lightblue') +  labs(x='Gesture semantic')
```

Наиболее часто жестами поясняется форма предмета, что коррелирует с данными о том, что иллюстративные жесты распространены в датасете. Примерно также часто (будем считать жесты с семантикой *относительная позиция* и их комбинации с другими вместе) жесты поясняют относительную положение объекта относительно говорящего, что коррелирует с распространенностью указательных жестов. Значение *количество* и *направление* встречаются редко.

То есть получается, что при объяснении пути говорящему важнее объяснить ориентиры и их положение относительно себя, нежели направление движения.

### Множественный анализ соответствий для признака Practice

Признак Practice представляет собой некие способы представления объекта с помощью жеста. Всего таких способов в датасете выделено 8 таких способов (по оригинальной статье Lücking et al., 2010):

1.  *Indexing* - указание на точку пространства

2.  *Placing* - объект оказывается фигурально помещен или поставлен на пол

3.  *Shaping* - форма объекта словно лепится говорящим в воздухе

4.  *Drawing* - в воздухе рисуется форма объекта, в частности границы

5.  *Posturing (modelling)* - руки образуют статичную конфигурацию в форме объекта

6.  *Sizing* - указание на расстояние до объекта или его размер

7.  *Counting* - счет на пальцах

8.  *Hedging* - фигуральный жест для чего-то неопределенного

Попробуем провести МАС для данного категориального признака и посмотреть как он распределен относительно нашей целевой переменной.

```{r fig.height=10}
library(factoextra)
library(FactoMineR)

gesture_features <- final_df %>%
  select(Practice, IsDeictic)

gesture_features_mca <- MCA(gesture_features, 
                     ncp = 2, 
                     graph = FALSE)

fviz_mca_biplot(gesture_features_mca,
                col.ind = "lightblue",
                col.var = "darkgreen",
                shape.ind = 10,
               ggtheme = theme_minimal())
```

Как видно, в датасете в отличие от оригинальной статьи названия данной категории несколько отличаются (posturing=modelling), также добавлены некоторые другие категории типа action, grasping, pantomime. По-видимому, разметчики решили расширить данную категорию.

На картинке дейктики и не-дейктики оказываются разделены осью Oy. Соответственно будем считать, что те способы представления объекта, что характерны для обоих типов вербальных единиц, находятся в окрестности нуля. Здесь можно сделать вывод, что для жестов в целом характерна описательность (вспомним, что большая часть наших жестов иллюстративная), которая включает в себя задание формы предмета (*drawing \| shaping \| modelling*) и определение его положения (*indexing*).

Различия между дейктиками и не-дейктиками может заключаться в том^1^, что с не-дейктиками чаще используются жесты "размера", "неопределенности" и "счета". Для дейктиков более характерны жесты с указанием точки пространства (*indexing*), а также комбинация указания формы объекта и помещения его в некоторое пространство.

^1^ - вспомним, что используемый датасет был специально уменьшен, поэтому тут возможен перекос

## Статистика и модель

Проверим, связаны ли такие жестовые признаки как HandShapeShape (форма жеста) и PalmDirection (направление ладони) с нашей целевой переменной с помощью статистического теста Фишера.

Для начала отметим, что форма жеста была размечена согласно стандартам американского жестого языка. Для разметки были использованы буквы, цифры и слова типа *маленький, ребёнок*. Направление же жеста размечалось аббревиатурами, включающими в себя а) двигается ли рука ладонью вверх или вниз, б) направление движения вперед-назад, вправо-влево или вверх-вниз.

![](https://t4.ftcdn.net/jpg/04/03/92/43/360_F_403924333_M7IFtDvn61Zuu7Ro3QKpOJY0TiJNX2nj.jpg){width="280"}

Сначала составим гипотезы:

**Н~0~**: жесты, сопровождающие дейктики, не отличаются по своей форме / направлению движения ладони.

**Н~1~**: жесты, сопровождающие дейктики, отличаются по своей форме / направлению движения ладони.

```{r}
handshape_corr <- fisher.test(final_df$HandShapeShape, final_df$IsDeictic, workspace=2e9, simulate.p.value=TRUE)
handshape_corr
```

```{r}
palmdirection_corr <- fisher.test(final_df$PalmDirection, final_df$IsDeictic, workspace=2e9, simulate.p.value=TRUE)
palmdirection_corr
```

Поскольку значение p-value меньше, чем **0.05** в обоих статистических тестах, то будем считать, что данные признаки статистически связаны с нашей целевой переменной.

Учитывая выводы предыдущих разделов, можно предположить, что поскольку для дейктиков и не-дейктиков свойственны разные типы жестов, то и форма жеста, и направление ладони будут различаться. Так, для типичного указательного жеста будет свойственна форма 5 (см. картинку выше) и направление ладони (вперед).

В качестве статистической модели была выбрана логистическая регрессия, поскольку целевая переменная бинарна. Для предсказания будем использовать только жестовые признаки Practice и Semantic, поскольку по предыдущим наблюдениям они являются важными в определении разницы между дейктиками и не-дейктиками, а также имеют приемлемое количество значений внутри категории, в отличие от HandShapeShape и PalmDirection.

```{r}
library(stats)
```

```{r}
gest.glm <- glm(IsDeictic ~ Semantic, final_df, family = binomial)
summary(gest.glm)
```

Отметим, что значение признака *Semantic* **direction-shape** сильно путает модель и с ним достаточно высокое значение ошибки. Возможно, это потому что он крайне редко встречается в датасете.

Модель, обученная только на признаке *Semantic*, имеет достаточно высокое значение AIC. Попробуем сравнить его с моделью, в которой будет учтён также признак *Practice*.

```{r}
gest.glm2 <- glm(IsDeictic ~ Practice + Semantic, family=binomial, data=final_df)
gest.glm2.bw <- step(gest.glm2, direction = "backward")
```

Для модели с двумя признаками видно, что признак *Semantic* чуть более информативен, нежели *Practice*, посколько его AIC сравнительно ниже. Но возможно, что дело лишь в количестве значений признака. Теперь посмотрим, какие параметры оказались самыми влиятельными.

```{r}
library(caret)
varImp(gest.glm2) %>%
  arrange(desc(Overall))
```

Среди параметров с наибольшим весом большая часть относится к признаку *Practice* - indexing, grasping-indexing, modelling-shaping, action. Если обратиться вновь к графику МАС, то станет ясно, что эти параметры наиболее характерны и отличают дейктики.

Также кажется, что признак *Practice* все же важен для модели и не стоит его исключать из неё.

## Выводы

-   Жесты, сопровождающие дейктики и не-дейктики действительно могут различаться между собой в *форме* и *семантике*. В частности, для дейктиков характерны жесты с указанием точки пространства (*indexing*), а также комбинация указания формы объекта и помещения его в некоторое пространство.

-   Не-дейктики сравнительно чаще сопровождаются жестами, описывающими размер объекта, некую неопределенность и счет предметов. Соответственно, они являются иллюстративными.

-   Фаза жеста не определяет не-дейктики и дейктики.
